"use strict";!function(e,t){!function(i,n){function a(){if(!o){o=!0;for(var t=0;t<r.length;t++)r[t].fn.call(e,r[t].ctx);r=[]}}function s(){("interactive"==t.readyState||"complete"==t.readyState||"loaded"==t.readyState)&&a()}i=i||"docReady",n=n||e;var r=[],o=!1,d=!1;n[i]=function(i,n){return o?void setTimeout(function(){i(n)},1):(r.push({fn:i,ctx:n}),void("interactive"==t.readyState||"complete"==t.readyState||"loaded"==t.readyState?setTimeout(a,1):d||(t.addEventListener?(t.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1)):(t.attachEvent("onreadystatechange",s),e.attachEvent("onload",a)),d=!0)))}}("_docReady",e);var i="_yeti",n=["","webkit","moz","MS","o"],a="Roboto:300,400,500",s="https://fonts.googleapis.com/css?family=",r="ZPYf5C",o=".starter-template",d="before",l="body > main > div > p.lead",c="append",u="",p="https://api.90d.io/stories/"+r+"/stories.json",m="https://cdn.automatad.com/player/story.css",v=/android|webos|iphone|ipod|blackberry|iemobile|opera mini/i.test(e.navigator.userAgent.toLowerCase()),g=/iphone|ipod/i.test(e.navigator.userAgent.toLowerCase()),f={},h=[],y="https://dc01.90d.io/divolte.js",_=!1,b=void 0,x=function(){return"undefined"!=typeof Storage},w=function(e){return e?(e+"").replace(new RegExp(/(^\s+|\s+$)/g),""):""},L=function(e,t,i){var n=new XMLHttpRequest;n.open("get",e,!0),i||(n.responseType="json"),n.onload=function(){var e=n.status;200==e?t(e,n.response):t(e,null)},n.send()},D=function(e,t,i,n){e.addEventListener?e.addEventListener(t,i,n?!0:!1):e.attachEvent&&e.attachEvent("on"+t,i)},C=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i):e.detachEvent&&e.detachEvent("on"+t,i)},I=function(){var t=function(){for(b||(b=e.divolte);h.length>0;)b.signal(h[0].type,h[0].attribute),h.splice(0,1)};_=e.setInterval(function(){h.length>0&&e.divolte&&t()},2e3),D(e,"beforeunload",function(){t()})},E=function(e,t){var i={page_id:"",story_id:"",domain_id:r,duration:"",story_index:"",thumbnail_id:"",widget_type:"",sound_status:""};for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]?String(t[n]):"");h.push({type:e,attribute:i}),_||I()},S=function(e){for(var i=0,n=0;e;){if("BODY"==e.tagName){var a=e.scrollLeft||t.documentElement.scrollLeft,s=e.scrollTop||t.documentElement.scrollTop;i+=e.offsetLeft-a+e.clientLeft,n+=e.offsetTop-s+e.clientTop}else i+=e.offsetLeft-e.scrollLeft+e.clientLeft,n+=e.offsetTop-e.scrollTop+e.clientTop;e=e.offsetParent}return{x:i,y:n}},k=function(){var e=new Date,t=e.getMonth()+1,i=e.getDate()+"-"+(10>t?"0"+t:t)+"-"+e.getFullYear();return i},q=function(e){var i=t.head||t.getElementsByTagName("head")[0]||t.documentElement,n=t.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(t.createTextNode(e)),i.appendChild(n)},T=function(e,t){t=w(t);var i=[];try{i=e.querySelectorAll(t)}catch(n){i=[]}return i},N=function(e,t){for(var i in t)t.hasOwnProperty(i)&&e.setAttribute(i,t[i])},A=function(e,i){var n=t.createElement(e);return i&&N(n,i),n},O=function(e,i){var n,a=0,s=function(e){n=A("link",{href:e,rel:"stylesheet"}),(t.head||t.getElementsByTagName("head")[0]).appendChild(n)};if(Array.isArray(e))for(;a<e.length;a++)s(e[a]);else s(e);i&&i(!0)},R=function(e,i){var n="RequestFullScreen",a="requestFullScreen";if(i)t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen();else try{e[a]?e[a]():e["ms"+n]?e["ms"+n]():e["moz"+n]?e["moz"+n]():e["webkit"+n]&&e["webkit"+n]()}catch(s){}},B=function(e){if(x()){var t=localStorage[i+"_story_keys_"],n=k(),a={seen:[],date:n};if(t){if(t=JSON.parse(t),t.date==n&&t.seen.indexOf(e)>-1)return!0;t.date!=n&&localStorage.setItem(i+"_story_keys_",JSON.stringify(a))}else localStorage.setItem(i+"_story_keys_",JSON.stringify(a))}return!1},F=function(e,t,n){for(var a=!1,s=0;s<e.length;s++)if(e[s].uniqueID==t){n>=e[s].pages.length-1&&(a=!0,e[s].elm.widgetElm&&e[s].elm.widgetElm.classList.add("seen"),e[s].elm.widgetCarousalElm&&e[s].elm.widgetCarousalElm.classList.add("seen"));break}if(x()&&a){var r=localStorage[i+"_story_keys_"];r&&(r=JSON.parse(r),-1==r.seen.indexOf(t)&&r.seen.push(t),localStorage.setItem(i+"_story_keys_",JSON.stringify(r)))}},J=function(e,t){if(x()){var n=localStorage[i+"_story_seen_keys_"],a=k();n?(n=JSON.parse(n),n.data[e]||(n.data[e]=0),n.date==a?n.data[e]=t:n.date!=a&&(n={date:a,data:{}},n.data[e]=0)):(n={date:a,data:{}},n.data[e]=0),localStorage.setItem(i+"_story_seen_keys_",JSON.stringify(n))}},M=function(e){var t=void 0,n=k(),a=e.uniqueID;if(x()){var s=localStorage[i+"_story_seen_keys_"];s&&(s=JSON.parse(s),s.date==n?void 0!==s.data[a]?s.data[a]==e.pages.length-1?t=0:s.data[a]>-1&&(t=s.data[a]):t=0:localStorage.removeItem(i+"_story_seen_keys_"))}return void 0===t&&(t=0),t},j=function(e){for(var t=0,i=[],n=[],a=e.widgets.stories;t<a.length;t++){try{a[t]=JSON.parse(a[t])}catch(s){continue}a[t].elm={};var r=B(a[t].uniqueID);a[t].isSeen=r,a[t].isRemoved=!0,r?n.push(a[t]):i.push(a[t])}return i=i.concat(n),e.widgets.stories=i,e},P=function(e,t){var i=function(e,t){var n="";switch(e){case"boxShadow":case"textShadow":"string"==typeof t[e]?n=t[e]:(n+=t.offset?t.offset.x+"px "+t.offset.y+"px ":"0px 0px ",void 0!==t.blurRadius&&(n+=t.blurRadius+"px "),void 0!==t.spread&&(n+=t.spread+"px "),n+=t.color);break;case"transform":case"filter":case"backdropFilter":for(var a in t)t.hasOwnProperty(a)&&(n+=a+"("+i(a,t)+") ");break;case"backgroundLinearGradient":if(t.stops){for(var s=[t.direction],r=0;r<t.stops.length;r++)s.push(t.stops[r].distance?"number"==typeof t.stops[r].distance?t.stops[r].color+" "+t.stops[r].distance+"%":t.stops[r].color+" "+t.stops[r].distance:t.stops[r].color);n="linear-gradient("+s.join(", ")+")"}break;case"border":case"borderTop":case"borderLeft":case"borderRight":case"borderBottom":n=t.width+"px "+t.style+" "+t.color;break;case"lineHeight":case"scale":case"fontWeight":case"opacity":n=t[e];break;default:n="string"==typeof t[e]?t[e]:t[e]+"px"}return n};for(var n in t)if(t.hasOwnProperty(n)){var a="",s=0,r=[];if(Array.isArray(t[n])){for(r=[];s<t[n].length;s++)r.push(i(n,t[n][s]));a=r.join(", ")}else a="object"==typeof t[n]?i(n,t[n]):i(n,t);"backgroundLinearGradient"==n?e.style.background=w(a):e.style[n]="string"==typeof a?w(a):a}},z=function(e,n,a){var s=A("div",{"class":i+"_story"}),r=A("div",{"class":i+"_full_screen"}),o=A("div",{"class":i+"_main_slider_cont"}),d=A("div",{"class":i+"_clearfix "+i+"_slider_cont"}),l=A("div",{"class":i+"_click_cntrl_container"}),c={},u=T(t,e)[0];return"append"==n?u.appendChild(s):"after"==n?u.parentNode.insertBefore(s,u.nextSibling):"before"==n?u.parentNode.insertBefore(s,u):"prepend"==n&&(u.childNodes.length>0?u.insertBefore(s,u.childNodes[0]):u.appendChild(s)),a?c={widget:s}:((t.body||t.getElementsByTagName("body")[0]).appendChild(r),r.appendChild(o),o.appendChild(d),r.appendChild(l),c={widget:s,fullStoryDiv:r,container:d,clickCont:l}),c},W=function(e,t,n){var a,s,r,o,d=0,l=A("ul",{"class":i+"_story_rail "+i+"_clearfix","widget-type":n?"carousel":"normal"}),c=t.widgets.stories,u=0,p=function(e,t,n,d,c,p){return o=A("li",d?{"class":"seen"+(c?" "+i+"_carousal":""),"data-id":t,"data-index":u}:{"data-id":t,"data-index":u,"class":c?" "+i+"_carousal":""}),c&&N(o,{style:"background-image:url("+p+")"}),a=A("div",{"class":i+"_rail_image_holder"}),s=A("div",{"class":i+"_rail_image",style:"background-image:url("+e+")"}),r=A("span",{"class":i+"_rail_info"}),r.innerText=n,l.appendChild(o),o.appendChild(a),a.appendChild(s),o.appendChild(r),u++,o};for(e.appendChild(l),P(e,t.widgets.defaultStyle);d<c.length;d++)if(n){var m=c[d].pages[0].layers[0],v=m.type;c[d].elm.widgetCarousalElm=p(c[d].thumbnail,c[d].uniqueID,c[d].name,c[d].isSeen,n,"image"==v?m.source:m.poster)}else c[d].elm.widgetElm=p(c[d].thumbnail,c[d].uniqueID,c[d].name,c[d].isSeen);return t.widgets.elm||(t.widgets.elm={}),n?t.widgets.elm.carWidget=e:t.widgets.elm.widget=e,E("widget_loaded",{widget_type:n?"carousel":"normal"}),t},Y=function(e){var i;t.createEvent?(i=t.createEvent("HTMLEvents"),i.initEvent("attributechange",!0,!0)):(i=t.createEventObject(),i.eventType="attributechange"),i.eventName="attributechange",t.createEvent?e.dispatchEvent(i):e.fireEvent("on"+i.eventType,i)},H=function(e,t,n){for(var a,s,r,o,d=[],l=[],c={},u=0,p=0,m=t.pages,v=M(t),h="https://90dfs.s3.amazonaws.com/staticfiles/videos/571ddf28-c4f5-4ff9-ab47-e99c15db1bba.png",y=function(e,i,n){var a;switch(e.type){case"video":for(var s=A("video",{preload:"auto",height:e.height,width:e.width,poster:e.poster||h,muted:"","webkit-playsinline":"",playsinline:"","page-index":i,"story-id":t.uniqueID,"story-index":n}),r=0;r<e.sources.length;r++)("application/x-mpegURL"!=e.sources[r].type||g)&&(g&&"application/x-mpegURL"==e.sources[r].type?s.prepend(A("source",{src:e.sources[r].source,type:e.sources[r].type})):s.appendChild(A("source",{src:e.sources[r].source,type:e.sources[r].type})));var o=function(e){var t=parseInt(this.getAttribute("story-index")||0),i=parseInt(this.getAttribute("page-index")||0),n=f.widgets.stories[t];"loadedmetadata"==e.type||"durationchange"==e.type?(n.pages[i].duration=this.duration+.05,n.elm.pointer[i].duration.style.animationDuration=this.duration+.05+"s"):"canplay"==e.type&&(n.elm.pages[i].setAttribute("load-status","done"),Y(this)),C(this,e.type,o)};D(s,"loadedmetadata",o),D(s,"durationchange",o),D(s,"canplay",o),s.muted=!0,a=s;break;case"image":var d=A("img",{src:e.source,height:e.height,width:e.width,"page-index":i,"story-id":t.uniqueID,"story-index":n});P(d,e.styles),D(d,"load",function(){var e=parseInt(this.getAttribute("story-index")||0),t=parseInt(this.getAttribute("page-index")||0);f.widgets.stories[e].elm.pages[t].setAttribute("load-status","done"),Y(this)}),a=d;break;case"container":var l=A("div"),r=0,c=A("span");if(P(l,e.styles),e.elements)for(;r<e.elements.length;r++)c.appendChild(y(e.elements[r])),l.appendChild(c);a=l;break;case"paragraph":var u=A("p"),r=0,c=A("span");if(P(u,e.styles),e.elements)for(;r<e.elements.length;r++)c.appendChild(y(e.elements[r])),u.appendChild(c);u.innerText=e.text,a=u;break;case"heading":case"heading1":case"heading2":case"heading3":case"heading4":case"heading5":case"heading6":var p=e.type.substr(e.type.length-1,1),m="h"+("g"==p?"1":p);a=A(m),a.innerText=e.text,P(a,e.styles)}return a};u<m.length;u++){for(a=A("li",{"class":i+"_story_page"+(v==u?" active":""),"data-index":u,"load-status":"loading"}),c={video:void 0,image:[]},p=0;p<m[u].layers.length;p++)r=A("div",{"class":i+"_page_layer",style:"z-index:"+(p+1)}),o=A("div",{"class":i+"_page_layer_inner"+("image"==m[u].layers[p].type||"video"==m[u].layers[p].type?" fill":"")}),s=y(m[u].layers[p],u,n),("image"==m[u].layers[p].type||"video"==m[u].layers[p].type)&&(N(a,{"data-type":m[u].layers[p].type}),"video"==m[u].layers[p].type?(c.video=s,s.load()):c.image.push(s)),o.appendChild(s),r.appendChild(o),a.appendChild(r);e.appendChild(a),d.push(a),l.push(c)}return{pages:d,layervid:l}},X=function(e,t,n){var a=f.widgets.stories,s=function(e,t,n){var a=A("div",{"class":i+"_header_left"}),s=A("div",{"class":i+"_header_right"}),r=A("div",{"class":i+"_header_middle"}),o=A("span",{"class":i+"_mute muted"}),d=A("div",{"class":i+"_header_image",style:"background-image:url("+t+")"}),l=A("span",{"class":i+"_story_name"}),c=A("span",{"class":i+"_close"});return l.innerText=n,a.appendChild(d),a.appendChild(l),c.innerHTML="&times;",s.appendChild(c),e.appendChild(a),e.appendChild(r),r.appendChild(o),e.appendChild(s),{close:c,mute:o}},r=function(e,t){for(var n=[],a=0;a<t.length;a++){var s=A("span",{"class":i+"_pointer","data-index":a}),r=A("b",{style:"animation-duration:5s"});s.appendChild(r),e.appendChild(s),n.push({pointer:s,duration:r})}return n};for(var o in t)if(t.hasOwnProperty(o)){var d=t[o];if(void 0!==d&&a[d].isRemoved){var l,c=a[d],u=A("div",{"data-id":c.uniqueID,"data-index":d,"class":i+"_slider"}),p=A("div",{"class":i+"_slider_pointer","data-id":c.uniqueID}),m=A("div",{"class":i+"_story_header","data-id":c.uniqueID}),v=A("ul",{"class":i+"_story_pages_list","data-id":c.uniqueID}),g=A("div",{"class":i+"_content_loader","data-id":c.uniqueID}),h=A("span",{"class":i+"_loader","data-id":c.uniqueID}),y=s(m,c.thumbnail,c.name);c.elm.mute=y.mute,c.elm.close=y.close,c.elm.pointer=[],c.elm.pointer=r(p,c.pages,c.uniqueID),l=H(v,c,d),c.elm.pages=l.pages,c.elm.vidimg=l.layervid,u.appendChild(p),u.appendChild(m),u.appendChild(v),u.appendChild(g),g.appendChild(h),e.appendChild(u),c.elm.slider=u,c.elm.loader=g,c.elm.pageCnt=v,c.isRemoved=!1}}n()},G=function(i){for(var a=f.widgets.stories,s=0,r=0,o=void 0,d=void 0,l=!0,c=void 0,u=void 0,p={},m=function(e){var t=Date.now();"page"==e&&u?(E("dwell_time_page",{page_id:d.pages[r].uniqueID,story_id:d.uniqueID,duration:String(t-u)}),u=t):"story"==e&&c&&(E("dwell_time_story",{story_id:d.uniqueID,duration:String(t-c)}),c=u=t)},h=function(){var e={prev:void 0,current:s,next:void 0},t=0==s?void 0:s-1,i=s==a.length-1?void 0:s+1;return void 0!==t&&(e.prev=t),void 0!==i&&(e.next=i),e},y=function(t,i,n,a,s){var r=i>0?1:-1,o=Math.abs(i)/e.innerWidth*90*r,d=0==o?"scale(0.95)":"scale(0.93, 0.93)";if(s&&(s.style.transform=d),-90>o||o>90)return!1;var l="rotateY("+o+"deg)";t&&(a&&(t.style.transitionTimingFunction=a),t.style.transitionDuration=n+"ms",t.style.transform=l)},_=function(e,t){for(var i=0,a=!1,s=function(){for(i=0;i<n.length;i++)C(e,n[i]+"transitionend",s);a||(a=!0,t())};i<n.length;i++)D(e,n[i]+"transitionend",s)},b=function(e){d&&d.elm&&(d.elm.loader.classList.add("active"),d.elm.pointer[e].pointer.classList.remove("active"),d.elm.pointer[e].pointer.classList.add("paused"))},x=function(e){d&&d.elm&&(d.elm.loader.classList.remove("active"),d.elm.pointer[e].pointer.classList.remove("paused"),d.elm.pointer[e].pointer.classList.add("active"))},w=function(e){e&&e.muted&&(e.muted=!1,e.volume=1),l=!1,p.prev&&a[p.prev].elm.mute.classList.remove("muted"),p.next&&a[p.next].elm.mute.classList.remove("muted"),a[p.current].elm.mute.classList.remove("muted")},L=function(e){e&&!e.muted&&(e.muted=!0,e.volume=0),l=!0,p.prev&&a[p.prev].elm.mute.classList.add("muted"),p.next&&a[p.next].elm.mute.classList.add("muted"),a[p.current].elm.mute.classList.add("muted")},I=function(){if(E("mute_unmute",{sound_status:l?"mute":"unmute",page_id:d.pages[r].uniqueID,story_id:d.uniqueID}),d&&d.elm&&d.elm.vidimg){var e=d.elm.vidimg[r].video;e&&(l?w(e):L(e))}},k=function(e){var t=0,i=0;for(t=0;t<a[e].elm.pointer.length;t++){for(a[e].pages[t].binded=!1,i=0;i<n.length;i++)C(a[e].elm.pointer[t].duration,n[i]+"animationend",W);a[e].elm.vidimg[t].image&&a[e].elm.vidimg[t].image.length>0&&C(a[e].elm.vidimg[t].image[0],"attributechange",T);var s=a[e].elm.vidimg[t].video;if(s){C(s,"playing",N),C(s,"waiting",N),C(s,"ended",A),C(s,"error",O),s.paused||s.pause(),s.removeAttribute("src");for(var r=s.children,o=0;o<r.length;o++)r[o].setAttribute("src",""),r[o].parentNode.removeChild(r[o]);s.src="",s.load()}}C(a[e].elm.close,"click",P),C(a[e].elm.mute,"click",I),["close","loader","mute","pageCnt","pages","pointer","vidimg"].forEach(function(t){delete a[e].elm[t]}),a[e].elm.slider.parentNode.removeChild(a[e].elm.slider),a[e].isRemoved=!0,a[e].binded=!1},q=function(e){var t={prev:0==s?void 0:s-1,current:s,next:s==a.length-1?void 0:s+1},i=-1;t.current>p.current?i=t.prev-1:t.current<p.current&&(i=t.next+1),i>-1&&i<a.length&&k(i),e()},T=function(){if(console.log("attributechange"),d&&d.uniqueID){var e=parseInt(this.getAttribute("page-index")||index),t=this.getAttribute("story-id");e==r&&t==d.uniqueID&&"done"==d.elm.pages[e].getAttribute("load-status")&&(x(e),C(this,"attributechange",T))}},N=function(e){var t=parseInt(this.getAttribute("page-index")||r),i=this.getAttribute("story-id");t==r&&i==d.uniqueID&&(l?L(this):w(this),"waiting"==e.type?b(t):x(t))},A=function(){this.currentTime=g?.1:0},O=function(){alert("Error "+this.error.code+"; details: "+this.error.message),console.log(this.error)},B=function(e){d.pages[e].binded=!0;var t=d.elm.vidimg[e].video;t&&(t.load(),D(t,"playing",N),D(t,"waiting",N),D(t,"ended",A),D(t,"error",O))},j=function(e,t,i){X(e,t,function(){var e=0,t=0;if(d=a[s],d.pages[r].binded||B(r),!d.binded){for(d.binded=!0,e=0;e<d.elm.pointer.length;e++)for(t=0;t<n.length;t++)D(d.elm.pointer[e].duration,n[t]+"animationend",W);D(d.elm.close,"click",P),D(d.elm.mute,"click",I);for(var o=0;o<d.elm.vidimg.length;o++)d.elm.vidimg[o].image&&d.elm.vidimg[o].image.length>0&&D(d.elm.vidimg[o].image[0],"attributechange",T)}i()})},P=function(){(t.body||t.getElementsByTagName("body")[0]).style.overflow="scroll",i.fullStoryDiv.classList.remove("active"),R(i.fullStoryDiv,!0),E("dismiss",{page_id:d.pages[r].uniqueID,story_id:d.uniqueID}),m("page"),m("story"),c=u=void 0,e.setTimeout(function(){var e=d.elm.vidimg[r].video;e&&!e.paused&&(e.pause(),e.currentTime=g?.1:0);for(var t in p)if(p.hasOwnProperty(t)){var i=p[t];void 0===i||a[i].isRemoved||k(i)}s=r=0,o=d=c=u=void 0,l=!0,p={}},300)},z=function(e){var t=p.prev,i=p.next;void 0===t||a[t].isRemoved||a[t].elm.slider.classList.add("prev"),void 0===i||a[i].isRemoved||a[i].elm.slider.classList.add("next"),a[p.current].elm.slider.classList.add("current"),a[p.current].elm.slider.classList.remove("next","prev"),void 0===t||a[t].isRemoved||a[t].elm.slider.classList.remove("current","next"),void 0===i||a[i].isRemoved||a[i].elm.slider.classList.remove("current","prev"),e()},W=function(){if(m("page"),r++,r<d.pages.length){J(d.uniqueID,r);var e=d.elm.vidimg[r-1].video;e&&!e.paused&&(e.pause(),e.currentTime=g?.1:0),U(function(){$()})}else r--,J(d.uniqueID,r),G()},Y=function(){if(m("page"),r--,r>-1){J(d.uniqueID,r);var e=d.elm.vidimg[r+1].video;e&&!e.paused&&(e.pause(),e.currentTime=g?.1:0),U(function(){$()})}else r++,J(d.uniqueID,r),H()},H=function(){m("story"),s--,s>-1?q(function(){p=h(s),d=a[s],o=d.uniqueID,r=M(d),j(i.container,p,function(){if(d.elm.pages.length>0){var t=function(){U(function(){z(function(){y(i.container,"0",0,null,i.container.parentNode||i.container.parentElement),$()})})};d.elm.pages[r].classList.add("active"),_(i.container,t),y(i.container,e.innerWidth,300,null,i.container.parentNode||i.container.parentElement)}else P()})}):P()},G=function(){m("story"),F(a,o,r),s++,s<a.length?q(function(){p=h(s),d=a[s],o=d.uniqueID,r=M(d),j(i.container,p,function(){if(d.elm.pages.length>0){var t=function(){U(function(){z(function(){y(i.container,"0",0,null,i.container.parentNode||i.container.parentElement),$()})})};d.elm.pages[r].classList.add("active"),_(i.container,t),y(i.container,-e.innerWidth,300,null,i.container.parentNode||i.container.parentElement)}else P()})}):P()},U=function(t){u||(u=Date.now());var i=0,n=d.elm.pages[r];n.classList.add("active"),e.setTimeout(function(){for(;i<d.elm.pages.length;i++)d.elm.pointer[i].duration.style.display="none",r>0&&r>i?(d.elm.pointer[i].pointer.classList.remove("paused","active"),d.elm.pointer[i].pointer.classList.add("seen")):d.elm.pointer[i].pointer.classList.remove("seen","paused"),i!=r&&d.elm.pages[i].classList.remove("seen","active","paused","long-press");d.pages[r].duration&&(d.elm.pointer[r].duration.style.animationDuration=d.pages[r].duration+"s"),t()})},Z=function(e){var t=e.play();void 0!==t&&t.then(function(){d.elm.pointer[r].duration.style.display="block",x(r)}).catch(function(){e.load(),b(r)})},$=function(){var t=d.elm.vidimg[r].video,i=d.elm.pages[r];d.elm.pointer[r].pointer.classList.remove("seen"),d.elm.pointer[r].duration.style.display="none",e.setTimeout(function(){t?(b(r),t.currentTime=g?.1:0,Z(t)):(d.elm.pointer[r].duration.style.display="block","done"==i.getAttribute("load-status")?x(r):b(r))})},K=function(){var n=this.parentNode.getAttribute("widget-type");e.location.hash="story",(t.body||t.getElementsByTagName("body")[0]).style.overflow="hidden",s=this.getAttribute("data-index")?parseInt(this.getAttribute("data-index")):0,o=this.getAttribute("data-id")?this.getAttribute("data-id"):void 0,r=M(a[s]),p=h(s),j(i.container,p,function(){R(i.fullStoryDiv),d=a[s],U(function(){z(function(){i.fullStoryDiv.classList.add("active"),setTimeout(function(){$()})})}),E("widget_tap",{story_index:s,story_id:d.uniqueID,thumbnail_id:d.thumbnailId,widget_type:n})})},Q=function(t){var n=!1,o={},l=void 0,c=void 0,u=void 0,p=void 0,m=void 0;v||(n=!0);var g=function(i){i.preventDefault();var a=i.touches?i.touches[0]:i;l={x:a.pageX,y:a.pageY,time:Date.now()},c=void 0,u=void 0,o=S(t),n&&(D(t,"mousemove",f),D(t,"mouseup",h),D(t,"mouseleave",h)),D(t,"touchmove",f),D(t,"touchend",h);var s=d.elm.vidimg[r].video;s&&!s.paused&&s.pause(),d.elm.pointer[r].pointer.classList.remove("active"),d.elm.pointer[r].pointer.classList.add("paused"),p=e.setTimeout(function(){d&&d.elm&&d.elm.pages[r].classList.add("long-press")},600),m=e.setTimeout(function(){e.clearInterval(m),m=!1},250)},f=function(e){var t=e.touches?e.touches[0]:e;l&&(u={x:t.pageX-l.x,y:t.pageY-l.y},void 0===c&&(c=!!(c||Math.abs(u.x)<Math.abs(u.y))),c||(e.preventDefault(),0==s&&o.x+u.x>140?P():s==a.length-1&&o.x+u.x<-140?P():y(i.container,o.x+u.x,0,null,i.container.parentNode||i.container.parentElement)))},h=function(){n&&(C(t,"mousemove",f),C(t,"mouseup",h),C(t,"mouseleave",h)),C(t,"touchmove",f),C(t,"touchend",h);var v=l,g=function(){d.elm.pointer[r].pointer.classList.remove("paused"),d.elm.pointer[r].pointer.classList.add("active");var e=d.elm.vidimg[r].video;e&&e.paused&&Z(e),d.elm.pages[r].classList.remove("long-press")};if(!u||0==u.x&&0==u.y)m?(e.clearInterval(p),m=!1,v.x>e.innerWidth/3?(E("forward_tap",{page_id:d.pages[r].uniqueID,story_id:d.uniqueID}),W()):(E("backward_tap",{page_id:d.pages[r].uniqueID,story_id:d.uniqueID}),Y())):g();else{var _=l?Date.now()-l.time:void 0,b=Number(_)<300&&Math.abs(u.x)>25||Math.abs(u.x)>e.innerWidth/3,x=u.x<0,w=x?s<a.length-1:s>0,L=x&&!w||!x&&!w;c||(b&&!L?x?(E("forward_swipe",{page_id:d.pages[r].uniqueID,story_id:d.uniqueID}),G()):(E("backward_swipe",{page_id:d.pages[r].uniqueID,story_id:d.uniqueID}),H()):(y(i.container,o.x,300,null,i.container.parentNode||i.container.parentElement),g()))}};D(t,"touchstart",g),n&&D(t,"mousedown",g)},V=0;V<a.length;V++)a[V].elm.widgetElm&&D(a[V].elm.widgetElm,"click",K),a[V].elm.widgetCarousalElm&&D(a[V].elm.widgetCarousalElm,"click",K);Q(i.clickCont)},U=function(){if(f=JSON.parse(f),f=j(f),f.widgets.stories){var e=[];if(f.fonts)for(var t=0;t<f.fonts.length;t++)e.push(s+f.fonts[t]);O(e);var i=z(o,d);if(f=W(i.widget,f),l){var n=z(l,c,!0);f=W(n.widget,f,!0)}G(i)}else console.log("Log : Sorry! no story data found in JSON.")},Z=t.createElement("script");Z.src=y,Z.type="text/javascript",Z.async=!0,(t.head||t.getElementsByTagName("head")[0]).appendChild(Z),O([s+a,m]),u&&""!=u&&q(u),_docReady(function(){L(p,function(e,t){f=t,U()},"application/json")})}(window,document);
