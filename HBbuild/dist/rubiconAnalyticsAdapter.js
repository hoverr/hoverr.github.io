pbjsChunk([12],{521:function(e,n,t){e.exports=t(522)},522:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"SEND_TIMEOUT",function(){return k}),n.parseBidResponse=w;var i=t(6),u=t(7),r=t(5),o=t.n(r),p=t(4),f=t(3),b=t(0),y=t(9);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(){return(g=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}var m,a=o.a.EVENTS,l=a.AUCTION_INIT,v=a.AUCTION_END,I=a.BID_REQUESTED,T=a.BID_RESPONSE,h=a.BIDDER_DONE,A=a.BID_TIMEOUT,E=a.BID_WON,U=a.SET_TARGETING,s=o.a.STATUS,O=s.GOOD,D=s.NO_BID;f.b.getConfig("s2sConfig",function(e){var n=e.s2sConfig;m=n});var S,k=3e3,N={auctions:{},targeting:{},timeouts:{}};function _(i){return Object.keys(i).reduce(function(e,n){var t=i[n];return"number"==typeof t?t=t.toFixed(3):"string"!=typeof t&&(t=String(t)),e[n]=t,e},{})}function C(e){return{width:e.w||e[0],height:e.h||e[1]}}function q(e){return-1!==["banner","native","video"].indexOf(e)}function j(e,n){function o(n){return b.pick(n,["bidder","bidId",function(e){return b.deepAccess(n,"bidResponse.seatBidId")||e},"status","error","source",function(e,n){return e||(m&&Array.isArray(m.bidders)&&-1!==m.bidders.indexOf(n.bidder)?"server":"client")},"clientLatencyMillis","serverLatencyMillis","params","bidResponse",function(e){return e?b.pick(e,["bidPriceUSD","dealId","dimensions","mediaType"]):void 0}])}function i(e){return g(o(e),b.pick(e.adUnit,["adUnitCode","transactionId","videoAdFormat",function(){return e.videoAdFormat},"mediaTypes"]),{adserverTargeting:_(N.targeting[e.adUnit.adUnitCode]||{}),bidwonStatus:"success",accountId:R,siteId:e.siteId,zoneId:e.zoneId,samplingFactor:M})}var t,a=N.auctions[e],r=f.b.getConfig("pageUrl")||a.referrer,s={eventTimeMillis:Date.now(),integration:f.b.getConfig("rubicon.int_type")||"pbjs",version:"3.9.0",referrerUri:r,referrerHostname:S||(t=r,S=y.c(t).hostname)},c=f.b.getConfig("rubicon.wrapperName");if(c&&(s.wrapperName=c),a&&!a.sent){var u=Object.keys(a.bids).reduce(function(e,n){var t=a.bids[n],i=e[t.adUnit.adUnitCode];i||((i=e[t.adUnit.adUnitCode]=b.pick(t.adUnit,["adUnitCode","transactionId","mediaTypes","dimensions","adserverTargeting",function(){return _(N.targeting[t.adUnit.adUnitCode]||{})}])).bids=[]),i.siteId&&i.zoneId||-1===F.indexOf(t.bidder)||b.deepAccess(t,"params.accountId")==R&&(i.accountId=parseInt(R),i.siteId=parseInt(b.deepAccess(t,"params.siteId")),i.zoneId=parseInt(b.deepAccess(t,"params.zoneId"))),t.videoAdFormat&&!i.videoAdFormat&&(i.videoAdFormat=t.videoAdFormat);var r=["error","no-bid","success"];return r.indexOf(t.status)>r.indexOf(i.status)&&(i.status=t.status),i.bids.push(o(t)),e},{});Object.keys(a.bids).forEach(function(e){var n=a.bids[e].adUnit.adUnitCode;g(a.bids[e],b.pick(u[n],["accountId","siteId","zoneId"]))});var d={clientTimeoutMillis:a.timeout,samplingFactor:M,accountId:R,adUnits:Object.keys(u).map(function(e){return u[e]})};m&&(d.serverTimeoutMillis=m.timeout),s.auctions=[d];var l=Object.keys(a.bidsWon).reduce(function(e,n){var t=a.bidsWon[n];return t&&e.push(i(a.bids[t])),e},[]);0<l.length&&(s.bidsWon=l),a.sent=!0}else n&&a&&a.bids[n]&&(s.bidsWon=[i(a.bids[n])]);Object(p.a)(this.getUrl(),null,JSON.stringify(s),{contentType:"application/json"})}function w(e,n){var t,i="string"==typeof(t=e).currency&&"USD"===t.currency.toUpperCase()?Number(t.cpm):"function"==typeof t.getCpmInNewCurrency?Number(t.getCpmInNewCurrency("USD")):void b.logWarn("Rubicon Analytics Adapter: Could not determine the bidPriceUSD of the bid ",t);return n&&n.bidPriceUSD>i?n:b.pick(e,["bidPriceUSD",function(){return i},"dealId","status","mediaType","dimensions",function(){return b.pick(e,["width","height"])},"seatBidId"])}var R,M=1,F=["rubicon"];var c=Object(i.a)({analyticsType:"endpoint"}),B=g({},c,{enableAnalytics:function(e){var n=0<arguments.length&&void 0!==e?e:{},t=!1;M=1,"object"===d(n.options)&&(n.options.accountId&&(R=Number(n.options.accountId)),n.options.endpoint?this.getUrl=function(){return n.options.endpoint}:(b.logError("required endpoint missing from rubicon analytics"),t=!0),void 0!==n.options.sampling&&(M=1/parseFloat(n.options.sampling)),void 0!==n.options.samplingFactor&&(void 0!==n.options.sampling&&b.logWarn("Both options.samplingFactor and options.sampling enabled in rubicon analytics, defaulting to samplingFactor"),M=parseFloat(n.options.samplingFactor),n.options.sampling=1/M));var i=[1,10,20,40,100];-1===i.indexOf(M)?(t=!0,b.logError("invalid samplingFactor for rubicon analytics: "+M+", must be one of "+i.join(", "))):R||(t=!0,b.logError("required accountId missing for rubicon analytics")),t||c.enableAnalytics.call(this,n)},disableAnalytics:function(){this.getUrl=c.getUrl,R=null,c.disableAnalytics.apply(this,arguments)},track:function(e){var n,t,i=this,r=e.eventType,o=e.args;switch(r){case l:t=u.default.aliasRegistry,Object.keys(t).forEach(function(e){"rubicon"===t[e]&&F.push(e)});var a=b.pick(o,["timestamp","timeout"]);a.bids={},a.bidsWon={},a.referrer=o.bidderRequests[0].refererInfo.referer,N.auctions[o.auctionId]=a;break;case I:g(N.auctions[o.auctionId].bids,o.bids.reduce(function(e,i){return N.auctions[o.auctionId].bidsWon[i.adUnitCode]=!1,e[i.bidId]=b.pick(i,["bidder",function(e){return e.toLowerCase()},"bidId","status",function(){return"no-bid"},"finalSource as source","params",function(e,n){switch(n.bidder){case"rubicon":return b.pick(e,["accountId","siteId","zoneId"])}},"videoAdFormat",function(e,n){if("rubicon"===n.bidder)return{201:"pre-roll",202:"interstitial",203:"outstream",204:"mid-roll",205:"post-roll",207:"vertical"}[b.deepAccess(i,"params.video.size_id")];var t=parseInt(b.deepAccess(i,"params.video.startdelay"),10);return isNaN(t)?void 0:0<t?"mid-roll":{0:"pre-roll","-1":"mid-roll","-2":"post-roll"}[t]},"adUnit",function(){return b.pick(i,["adUnitCode","transactionId","sizes as dimensions",function(e){return e.map(C)},"mediaTypes",function(e){return i.mediaType&&q(i.mediaType)?[i.mediaType]:Array.isArray(e)?e.filter(q):"object"===d(e)?(i.sizes||(i.dimensions=[],b._each(e,function(e){return i.dimensions=i.dimensions.concat(e.sizes.map(C))})),Object.keys(e).filter(q)):["banner"]}])}]),e},{}));break;case T:var s=N.auctions[o.auctionId].bids[o.requestId];if(!s){b.logError("Rubicon Anlytics Adapter Error: Could not find associated bid request for bid response with requestId: ",o.requestId);break}switch(s.source=(void 0===(n=s.source||o.source)?n="client":"s2s"===n&&(n="server"),n.toLowerCase()),o.getStatusCode()){case O:s.status="success",delete s.error;break;case D:s.status="no-bid",delete s.error;break;default:s.status="error",s.error={code:"request-error"}}s.clientLatencyMillis=Date.now()-N.auctions[o.auctionId].timestamp,s.bidResponse=w(o,s.bidResponse);break;case h:o.bids.forEach(function(e){var n=N.auctions[e.auctionId].bids[e.bidId||e.requestId];void 0!==e.serverResponseTimeMs&&(n.serverLatencyMillis=e.serverResponseTimeMs),n.status||(n.status="no-bid"),n.clientLatencyMillis||(n.clientLatencyMillis=Date.now()-N.auctions[e.auctionId].timestamp)});break;case U:g(N.targeting,o);break;case E:var c=N.auctions[o.auctionId];c.bidsWon[o.adUnitCode]=o.requestId,!0===c.sent?j.call(this,o.auctionId,o.requestId):Object.keys(c.bidsWon).reduce(function(e,n){return e=e&&c.bidsWon[n]},!0)&&(clearTimeout(N.timeouts[o.auctionId]),delete N.timeouts[o.auctionId],j.call(this,o.auctionId));break;case v:N.timeouts[o.auctionId]=setTimeout(function(){j.call(i,o.auctionId)},k);break;case A:o.forEach(function(e){var n=N.auctions[e.auctionId].bids[e.bidId||e.requestId];n.status="error",n.error={code:"timeout-error"}})}}});u.default.registerAnalyticsAdapter({adapter:B,code:"rubicon"}),n.default=B},6:function(e,n,t){"use strict";n.a=function(e){var r,o=e.url,n=e.analyticsType,a=e.global,i=e.handler,s=[],c=0,t=!0;n!==N&&!_||function(){if(t){for(var e=0;e<s.length;e++)s[e]();s.push=function(e){e()},t=!1}y.logMessage("event count sent to ".concat(a,": ").concat(c))}();return{track:function(e){var n=e.eventType,t=e.args;this.getAdapterType()===_&&window[a](i,n,t);this.getAdapterType()===N&&function(e){var n=e.eventType,t=e.args,i=e.callback;Object(l.a)(o,i,JSON.stringify({eventType:n,args:t}))}.apply(void 0,arguments)},enqueue:u,enableAnalytics:d,disableAnalytics:function(){y._each(r,function(e,n){b.off(n,e)}),this.enableAnalytics=this._oldEnable?this._oldEnable:d},getAdapterType:function(){return n},getGlobal:function(){return a},getHandler:function(){return i},getUrl:function(){return o}};function u(e){var n=e.eventType,t=e.args,i=this;a&&window[a]&&n&&t?this.track({eventType:n,args:t}):s.push(function(){c++,i.track({eventType:n,args:t})})}function d(n){var e,t=this,i=this;"object"!==f(n)||"object"!==f(n.options)||(void 0===n.options.sampling||Math.random()<parseFloat(n.options.sampling))?(b.getEvents().forEach(function(e){if(e){var n=e.eventType,t=e.args;n!==T&&u.call(i,{eventType:n,args:t})}}),p(e={},v,function(e){return t.enqueue({eventType:v,args:e})}),p(e,I,function(e){return t.enqueue({eventType:I,args:e})}),p(e,h,function(e){return t.enqueue({eventType:h,args:e})}),p(e,A,function(e){return t.enqueue({eventType:A,args:e})}),p(e,T,function(e){return t.enqueue({eventType:T,args:e})}),p(e,E,function(e){return t.enqueue({eventType:E,args:e})}),p(e,U,function(e){return t.enqueue({eventType:U,args:e})}),p(e,O,function(e){return t.enqueue({eventType:O,args:e})}),p(e,D,function(e){return t.enqueue({eventType:D,args:e})}),p(e,m,function(e){return t.enqueue({eventType:m,args:e})}),p(e,S,function(e){return t.enqueue({eventType:S,args:e})}),p(e,k,function(e){return t.enqueue({eventType:k,args:e})}),p(e,g,function(e){e.config="object"===f(n)&&n.options||{},t.enqueue({eventType:g,args:e})}),r=e,y._each(r,function(e,n){b.on(n,e)})):y.logMessage('Analytics adapter for "'.concat(a,'" disabled by sampling'));this._oldEnable=this.enableAnalytics,this.enableAnalytics=function(){return y.logMessage('Analytics adapter for "'.concat(a,'" already enabled, unnecessary call to `enableAnalytics`.'))}}};var i=t(5),r=t.n(i),l=t(4);function p(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var b=t(8),y=t(0),o=r.a.EVENTS,g=o.AUCTION_INIT,m=o.AUCTION_END,v=o.REQUEST_BIDS,I=o.BID_REQUESTED,T=o.BID_TIMEOUT,h=o.BID_RESPONSE,A=o.NO_BID,E=o.BID_WON,U=o.BID_ADJUSTMENT,O=o.BIDDER_DONE,D=o.SET_TARGETING,S=o.AD_RENDER_FAILED,k=o.ADD_AD_UNITS,N="endpoint",_="bundle"}},[521]);