pbjsChunk([13],{538:function(e,n,t){e.exports=t(539)},539:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"SEND_TIMEOUT",function(){return O}),n.getHostNameFromReferer=N,n.parseBidResponse=R;var r=t(6),u=t(7),i=t(5),o=t.n(i),l=t(4),p=t(3),f=t(0),a=t(9);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){return(b=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var y,s=o.a.EVENTS,m=s.AUCTION_INIT,g=s.AUCTION_END,v=s.BID_REQUESTED,I=s.BID_RESPONSE,T=s.BIDDER_DONE,h=s.BID_TIMEOUT,A=s.BID_WON,E=s.SET_TARGETING,c=o.a.STATUS,U=c.GOOD,D=c.NO_BID;p.b.getConfig("s2sConfig",function(e){var n=e.s2sConfig;y=n});var O=3e3,S={auctions:{},targeting:{},timeouts:{}};function N(n){try{B.referrerHostname=a.c(n,{noDecodeWholeURL:!0}).hostname}catch(e){f.logError("Rubicon Analytics: Unable to parse hostname from supplied url: ",n,e),B.referrerHostname=""}return B.referrerHostname}function k(r){return Object.keys(r).reduce(function(e,n){var t=r[n];return"number"==typeof t?t=t.toFixed(3):"string"!=typeof t&&(t=String(t)),e[n]=t,e},{})}function _(e){return{width:e.w||e[0],height:e.h||e[1]}}function C(e){return-1!==["banner","native","video"].indexOf(e)}function q(e,n){function o(n){return f.pick(n,["bidder","bidId",function(e){return f.deepAccess(n,"bidResponse.seatBidId")||e},"status","error","source",function(e,n){return e||(y&&Array.isArray(y.bidders)&&-1!==y.bidders.indexOf(n.bidder)?"server":"client")},"clientLatencyMillis","serverLatencyMillis","params","bidResponse",function(e){return e?f.pick(e,["bidPriceUSD","dealId","dimensions","mediaType"]):void 0}])}function r(e){return b(o(e),f.pick(e.adUnit,["adUnitCode","transactionId","videoAdFormat",function(){return e.videoAdFormat},"mediaTypes"]),{adserverTargeting:k(S.targeting[e.adUnit.adUnitCode]||{}),bidwonStatus:"success",accountId:j,siteId:e.siteId,zoneId:e.zoneId,samplingFactor:w})}var a=S.auctions[e],t=p.b.getConfig("pageUrl")||a.referrer,i={eventTimeMillis:Date.now(),integration:p.b.getConfig("rubicon.int_type")||"pbjs",version:"3.13.0-pre",referrerUri:t,referrerHostname:B.referrerHostname||N(t)},s=p.b.getConfig("rubicon.wrapperName");if(s&&(i.wrapperName=s),a&&!a.sent){var c=Object.keys(a.bids).reduce(function(e,n){var t=a.bids[n],r=e[t.adUnit.adUnitCode];r||((r=e[t.adUnit.adUnitCode]=f.pick(t.adUnit,["adUnitCode","transactionId","mediaTypes","dimensions","adserverTargeting",function(){return k(S.targeting[t.adUnit.adUnitCode]||{})}])).bids=[]),r.siteId&&r.zoneId||-1===F.indexOf(t.bidder)||f.deepAccess(t,"params.accountId")==j&&(r.accountId=parseInt(j),r.siteId=parseInt(f.deepAccess(t,"params.siteId")),r.zoneId=parseInt(f.deepAccess(t,"params.zoneId"))),t.videoAdFormat&&!r.videoAdFormat&&(r.videoAdFormat=t.videoAdFormat);var i=["error","no-bid","success"];return i.indexOf(t.status)>i.indexOf(r.status)&&(r.status=t.status),r.bids.push(o(t)),e},{});Object.keys(a.bids).forEach(function(e){var n=a.bids[e].adUnit.adUnitCode;b(a.bids[e],f.pick(c[n],["accountId","siteId","zoneId"]))});var u={clientTimeoutMillis:a.timeout,samplingFactor:w,accountId:j,adUnits:Object.keys(c).map(function(e){return c[e]})};y&&(u.serverTimeoutMillis=y.timeout),i.auctions=[u];var d=Object.keys(a.bidsWon).reduce(function(e,n){var t=a.bidsWon[n];return t&&e.push(r(a.bids[t])),e},[]);0<d.length&&(i.bidsWon=d),a.sent=!0}else n&&a&&a.bids[n]&&(i.bidsWon=[r(a.bids[n])]);Object(l.a)(this.getUrl(),null,JSON.stringify(i),{contentType:"application/json"})}function R(e,n){var t,r="string"==typeof(t=e).currency&&"USD"===t.currency.toUpperCase()?Number(t.cpm):"function"==typeof t.getCpmInNewCurrency?Number(t.getCpmInNewCurrency("USD")):void f.logWarn("Rubicon Analytics Adapter: Could not determine the bidPriceUSD of the bid ",t);return n&&n.bidPriceUSD>r?n:f.pick(e,["bidPriceUSD",function(){return r},"dealId","status","mediaType","dimensions",function(){return f.pick(e,["width","height"])},"seatBidId"])}var j,w=1,F=["rubicon"];var M=Object(r.a)({analyticsType:"endpoint"}),B=b({},M,{referrerHostname:"",enableAnalytics:function(e){var n=0<arguments.length&&void 0!==e?e:{},t=!1;w=1,"object"===d(n.options)&&(n.options.accountId&&(j=Number(n.options.accountId)),n.options.endpoint?this.getUrl=function(){return n.options.endpoint}:(f.logError("required endpoint missing from rubicon analytics"),t=!0),void 0!==n.options.sampling&&(w=1/parseFloat(n.options.sampling)),void 0!==n.options.samplingFactor&&(void 0!==n.options.sampling&&f.logWarn("Both options.samplingFactor and options.sampling enabled in rubicon analytics, defaulting to samplingFactor"),w=parseFloat(n.options.samplingFactor),n.options.sampling=1/w));var r=[1,10,20,40,100];-1===r.indexOf(w)?(t=!0,f.logError("invalid samplingFactor for rubicon analytics: "+w+", must be one of "+r.join(", "))):j||(t=!0,f.logError("required accountId missing for rubicon analytics")),t||M.enableAnalytics.call(this,n)},disableAnalytics:function(){this.getUrl=M.getUrl,j=null,M.disableAnalytics.apply(this,arguments)},track:function(e){var n,t,r=this,i=e.eventType,o=e.args;switch(i){case m:t=u.default.aliasRegistry,Object.keys(t).forEach(function(e){"rubicon"===t[e]&&F.push(e)});var a=f.pick(o,["timestamp","timeout"]);a.bids={},a.bidsWon={},a.referrer=o.bidderRequests[0].refererInfo.referer,S.auctions[o.auctionId]=a;break;case v:b(S.auctions[o.auctionId].bids,o.bids.reduce(function(e,r){return S.auctions[o.auctionId].bidsWon[r.adUnitCode]=!1,e[r.bidId]=f.pick(r,["bidder",function(e){return e.toLowerCase()},"bidId","status",function(){return"no-bid"},"finalSource as source","params",function(e,n){switch(n.bidder){case"rubicon":return f.pick(e,["accountId","siteId","zoneId"])}},"videoAdFormat",function(e,n){if("rubicon"===n.bidder)return{201:"pre-roll",202:"interstitial",203:"outstream",204:"mid-roll",205:"post-roll",207:"vertical"}[f.deepAccess(r,"params.video.size_id")];var t=parseInt(f.deepAccess(r,"params.video.startdelay"),10);return isNaN(t)?void 0:0<t?"mid-roll":{0:"pre-roll","-1":"mid-roll","-2":"post-roll"}[t]},"adUnit",function(){return f.pick(r,["adUnitCode","transactionId","sizes as dimensions",function(e){return e.map(_)},"mediaTypes",function(e){return r.mediaType&&C(r.mediaType)?[r.mediaType]:Array.isArray(e)?e.filter(C):"object"===d(e)?(r.sizes||(r.dimensions=[],f._each(e,function(e){return r.dimensions=r.dimensions.concat(e.sizes.map(_))})),Object.keys(e).filter(C)):["banner"]}])}]),e},{}));break;case I:var s=S.auctions[o.auctionId].bids[o.requestId];if(!s){f.logError("Rubicon Anlytics Adapter Error: Could not find associated bid request for bid response with requestId: ",o.requestId);break}switch(s.source=(void 0===(n=s.source||o.source)?n="client":"s2s"===n&&(n="server"),n.toLowerCase()),o.getStatusCode()){case U:s.status="success",delete s.error;break;case D:s.status="no-bid",delete s.error;break;default:s.status="error",s.error={code:"request-error"}}s.clientLatencyMillis=Date.now()-S.auctions[o.auctionId].timestamp,s.bidResponse=R(o,s.bidResponse);break;case T:o.bids.forEach(function(e){var n=S.auctions[e.auctionId].bids[e.bidId||e.requestId];void 0!==e.serverResponseTimeMs&&(n.serverLatencyMillis=e.serverResponseTimeMs),n.status||(n.status="no-bid"),n.clientLatencyMillis||(n.clientLatencyMillis=Date.now()-S.auctions[e.auctionId].timestamp)});break;case E:b(S.targeting,o);break;case A:var c=S.auctions[o.auctionId];c.bidsWon[o.adUnitCode]=o.requestId,!0===c.sent?q.call(this,o.auctionId,o.requestId):Object.keys(c.bidsWon).reduce(function(e,n){return e=e&&c.bidsWon[n]},!0)&&(clearTimeout(S.timeouts[o.auctionId]),delete S.timeouts[o.auctionId],q.call(this,o.auctionId));break;case g:S.timeouts[o.auctionId]=setTimeout(function(){q.call(r,o.auctionId)},O);break;case h:o.forEach(function(e){var n=S.auctions[e.auctionId].bids[e.bidId||e.requestId];n.status="error",n.error={code:"timeout-error"}})}}});u.default.registerAnalyticsAdapter({adapter:B,code:"rubicon"}),n.default=B},6:function(e,n,t){"use strict";n.a=function(e){var i,o=e.url,n=e.analyticsType,a=e.global,r=e.handler,s=[],c=0,t=!0;n!==k&&!_||function(){if(t){for(var e=0;e<s.length;e++)s[e]();s.push=function(e){e()},t=!1}y.logMessage("event count sent to ".concat(a,": ").concat(c))}();return{track:function(e){var n=e.eventType,t=e.args;this.getAdapterType()===_&&window[a](r,n,t);this.getAdapterType()===k&&function(e){var n=e.eventType,t=e.args,r=e.callback;Object(l.a)(o,r,JSON.stringify({eventType:n,args:t}))}.apply(void 0,arguments)},enqueue:u,enableAnalytics:d,disableAnalytics:function(){y._each(i,function(e,n){b.off(n,e)}),this.enableAnalytics=this._oldEnable?this._oldEnable:d},getAdapterType:function(){return n},getGlobal:function(){return a},getHandler:function(){return r},getUrl:function(){return o}};function u(e){var n=e.eventType,t=e.args,r=this;a&&window[a]&&n&&t?this.track({eventType:n,args:t}):s.push(function(){c++,r.track({eventType:n,args:t})})}function d(n){var e,t=this,r=this;"object"!==f(n)||"object"!==f(n.options)||(void 0===n.options.sampling||Math.random()<parseFloat(n.options.sampling))?(b.getEvents().forEach(function(e){if(e){var n=e.eventType,t=e.args;n!==T&&u.call(r,{eventType:n,args:t})}}),p(e={},v,function(e){return t.enqueue({eventType:v,args:e})}),p(e,I,function(e){return t.enqueue({eventType:I,args:e})}),p(e,h,function(e){return t.enqueue({eventType:h,args:e})}),p(e,A,function(e){return t.enqueue({eventType:A,args:e})}),p(e,T,function(e){return t.enqueue({eventType:T,args:e})}),p(e,E,function(e){return t.enqueue({eventType:E,args:e})}),p(e,U,function(e){return t.enqueue({eventType:U,args:e})}),p(e,D,function(e){return t.enqueue({eventType:D,args:e})}),p(e,O,function(e){return t.enqueue({eventType:O,args:e})}),p(e,g,function(e){return t.enqueue({eventType:g,args:e})}),p(e,S,function(e){return t.enqueue({eventType:S,args:e})}),p(e,N,function(e){return t.enqueue({eventType:N,args:e})}),p(e,m,function(e){e.config="object"===f(n)&&n.options||{},t.enqueue({eventType:m,args:e})}),i=e,y._each(i,function(e,n){b.on(n,e)})):y.logMessage('Analytics adapter for "'.concat(a,'" disabled by sampling'));this._oldEnable=this.enableAnalytics,this.enableAnalytics=function(){return y.logMessage('Analytics adapter for "'.concat(a,'" already enabled, unnecessary call to `enableAnalytics`.'))}}};var r=t(5),i=t.n(r),l=t(4);function p(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var b=t(8),y=t(0),o=i.a.EVENTS,m=o.AUCTION_INIT,g=o.AUCTION_END,v=o.REQUEST_BIDS,I=o.BID_REQUESTED,T=o.BID_TIMEOUT,h=o.BID_RESPONSE,A=o.NO_BID,E=o.BID_WON,U=o.BID_ADJUSTMENT,D=o.BIDDER_DONE,O=o.SET_TARGETING,S=o.AD_RENDER_FAILED,N=o.ADD_AD_UNITS,k="endpoint",_="bundle"}},[538]);